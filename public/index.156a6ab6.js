const e="https://fe24-js2-slutprojekt-back-linn-ahlrot.onrender.com/api";async function t(){try{let t=await fetch(`${e}/board`);if(!t.ok)throw Error(`Failed to fetch board: ${t.statusText}`);return await t.json()}catch(e){return alert(e),{members:[],assignments:[]}}}async function a(t,a){try{let r=await fetch(`${e}/members`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:t,roles:a})});if(!r.ok)throw Error(`Failed to add member: ${r.statusText}`);return await r.json()}catch(e){return alert(e),null}}async function r(t,a,r){try{let n=await fetch(`${e}/assignments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:t,description:a,category:r})});if(!n.ok)throw Error(`Failed to create assignment: ${n.statusText}`);return await n.json()}catch(e){return alert(e),null}}async function n(t,a){try{let r=await fetch(`${e}/assignments/assign`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({assignmentId:t,memberId:a})});if(!r.ok)throw Error(`Failed to assign task: ${r.statusText}`);return!0}catch(e){return alert(e),!1}}async function o(t){try{let a=await fetch(`${e}/assignments/${t}/done`,{method:"PATCH"});if(!a.ok)throw Error(`Failed to mark task as done: ${a.statusText}`);return!0}catch(e){return alert(e),!1}}async function s(t){try{let a=await fetch(`${e}/assignments/${t}`,{method:"DELETE"});if(!a.ok)throw Error(`Failed to delete task: ${a.statusText}`);return!0}catch(e){return alert(e),!1}}class l{static async create(e,t,a){return await r(e,t,a)}static async assign(e,t){return await n(e,t)}static async markAsDone(e){return await o(e)}static async remove(e){return await s(e)}}function i(e,t){let a={new:document.querySelector("#newTasks"),"in progress":document.querySelector("#inProgressTasks"),done:document.querySelector("#doneTasks")};Object.values(a).forEach(e=>{let t=e.querySelector("h2");e.innerHTML="",t&&e.appendChild(t)}),e.forEach(e=>{let r=document.createElement("div");if(r.className="task",r.innerHTML=`
      <strong>${e.title}</strong><br>
      ${e.description}<br>
      <small>${e.category}</small><br>
      <small>${e.status}</small><br>
      <small>${new Date(e.timestamp).toLocaleString()}</small><br>
      ${e.assigned?`Assigned to: ${t.find(t=>t.id===e.assigned)?.name||"Unknown"}`:""}
    `,"new"===e.status){let a=document.createElement("select");t.filter(t=>t.roles.includes(e.category)).forEach(e=>{let t=document.createElement("option");t.value=e.id,t.textContent=e.name,a.appendChild(t)});let n=document.createElement("button");n.textContent="Assign",n.onclick=async()=>{await l.assign(e.id,a.value),location.reload()},r.appendChild(a),r.appendChild(n)}else if("in progress"===e.status){let t=document.createElement("button");t.textContent="Mark as done",t.onclick=async()=>{await l.markAsDone(e.id),location.reload()},r.appendChild(t)}else if("done"===e.status){let t=document.createElement("button");t.textContent="Delete",t.onclick=async()=>{await l.remove(e.id),location.reload()},r.appendChild(t)}a[e.status].appendChild(r)})}const c=document.querySelector("#addMemberForm"),u=document.querySelector("#addTaskForm");let m=[],d=[];function f(){let{sortOption:e,roleFilter:t,memberFilter:a}={sortOption:document.querySelector("#sortTasks").value,roleFilter:document.querySelector("#filterTasks").value,memberFilter:document.querySelector("#filterMembers").value};i(function(e,t,a,r){let n=e.filter(e=>"new"===e.status),o=e.filter(e=>"in progress"===e.status),s=e.filter(e=>"done"===e.status),l=[...o];return"all"!==a&&(l=l.filter(e=>e.category===a)),"all"!==r&&(l=l.filter(e=>e.assigned===r)),[...n,...function(e,t){let[a,r]=t.split("-");return e.sort((e,t)=>{if("timestamp"===a){let a=new Date(e.timestamp),n=new Date(t.timestamp);return"asc"===r?a.getTime()-n.getTime():n.getTime()-a.getTime()}return"title"===a?"desc"===r?e.title.localeCompare(t.title):t.title.localeCompare(e.title):0})}([...l],t),...s]}(d,e,t,a),m)}(async function(){let e=await t();m=e.members,i(d=e.assignments,m),function(e){let t=document.querySelector("#filterMembers");for(;t.options.length>1;)t.remove(1);e.forEach(e=>{let a=document.createElement("option");a.value=e.id,a.textContent=e.name,t.appendChild(a)})}(m),function(e){let t=document.querySelector("#sortTasks");[t,document.querySelector("#filterTasks"),document.querySelector("#filterMembers")].forEach(t=>{t.addEventListener("change",e)})}(f),c.addEventListener("submit",async e=>{e.preventDefault();let t=document.querySelector("#memberName").value,r=Array.from(document.querySelector("#memberRoles").selectedOptions).map(e=>e.value);await a(t,r),location.reload()}),u.addEventListener("submit",async e=>{e.preventDefault();let t=document.querySelector("#taskTitle").value,a=document.querySelector("#taskDescription").value,r=document.querySelector("#taskCategory").value;await l.create(t,a,r),location.reload()})})(),c.reset(),u.reset();
//# sourceMappingURL=index.156a6ab6.js.map
